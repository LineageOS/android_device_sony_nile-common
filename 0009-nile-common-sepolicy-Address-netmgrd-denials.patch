From 773818bd8fe07876240063e66dc7c6b9ac75a3a4 Mon Sep 17 00:00:00 2001
From: LuK1337 <priv.luk@gmail.com>
Date: Tue, 4 Sep 2018 16:35:38 +0200
Subject: [PATCH 09/35] nile-common: sepolicy: Address netmgrd denials

Change-Id: I2fcd2d631b660328dc22ea7faec09db36347ec12
---
 sepolicy/vendor/netmgrd.te        | 2 ++
 sepolicy/vendor/property.te       | 1 +
 sepolicy/vendor/property_contexts | 1 +
 3 files changed, 4 insertions(+)
 create mode 100644 sepolicy/vendor/netmgrd.te

diff --git a/sepolicy/vendor/netmgrd.te b/sepolicy/vendor/netmgrd.te
new file mode 100644
index 0000000..223ee42
--- /dev/null
+++ b/sepolicy/vendor/netmgrd.te
@@ -0,0 +1,2 @@
+# Allow netmgrd to set vendor_net_radio_prop
+set_prop(netmgrd, vendor_net_radio_prop)
diff --git a/sepolicy/vendor/property.te b/sepolicy/vendor/property.te
index b3c91cd..3478448 100644
--- a/sepolicy/vendor/property.te
+++ b/sepolicy/vendor/property.te
@@ -3,3 +3,4 @@ type secd_prop, property_type;
 type semc_version_prop, property_type;
 type sony_modemswitcher_prop, property_type;
 type tareset_notfirstboot_prop, property_type;
+type vendor_net_radio_prop, property_type;
diff --git a/sepolicy/vendor/property_contexts b/sepolicy/vendor/property_contexts
index e2b29ca..11147a4 100644
--- a/sepolicy/vendor/property_contexts
+++ b/sepolicy/vendor/property_contexts
@@ -1,5 +1,6 @@
 persist.audio.gain.version       u:object_r:audio_gain_prop:s0
 persist.keyprovd.suntory.prov    u:object_r:secd_prop:s0
+persist.net.doxlat               u:object_r:vendor_net_radio_prop:s0
 persist.tareset.notfirstboot     u:object_r:tareset_notfirstboot_prop:s0
 semc.version.                    u:object_r:semc_version_prop:s0
 sony.modemswitcher               u:object_r:sony_modemswitcher_prop:s0
-- 
2.17.1

